在 Python 中，`if __name__ == "__main__":` 是一个非常实用的代码结构，它的核心作用是**区分模块的两种运行方式**：直接运行 vs 被导入到其他模块中运行。


### 1. 先理解 `__name__` 变量
`__name__` 是 Python 的**内置特殊变量**，每个 `.py` 文件（模块）都自带这个变量，它的值取决于该模块的**运行方式**：

- 当模块**被直接运行**时（比如在命令行执行 `python 文件名.py`），`__name__` 的值会被自动设置为 `"__main__"`。
- 当模块**被导入到其他模块中**时（比如在 `a.py` 中用 `import b` 导入 `b.py`），`__name__` 的值会被设置为该模块的**文件名**（不含 `.py` 后缀）。


### 2. `if __name__ == "__main__":` 的作用
这个条件语句的作用是：**当模块被直接运行时，执行缩进块内的代码；当模块被导入时，不执行这些代码**。

它的本质是为模块添加“**双模式**”能力：
- 作为**脚本直接运行**时，执行一些测试代码、主程序逻辑等。
- 作为**模块被导入**时，只提供函数、类等工具，不执行额外代码。


### 3. 示例说明
假设我们有一个 `calculator.py` 文件，内容如下：

```python
# calculator.py

def add(a, b):
    return a + b

# 以下代码会根据运行方式决定是否执行
if __name__ == "__main__":
    # 当直接运行 calculator.py 时，执行这里的代码
    print("模块被直接运行了！")
    result = add(2, 3)
    print(f"2 + 3 = {result}")
```


#### 情况1：直接运行 `calculator.py`
在命令行执行 `python calculator.py`，此时 `__name__` 的值是 `"__main__"`，条件成立，会输出：
```
模块被直接运行了！
2 + 3 = 5
```


#### 情况2：将 `calculator.py` 导入到其他模块
创建一个 `test.py` 文件，导入 `calculator.py`：
```python
# test.py
import calculator  # 导入 calculator 模块

# 使用 calculator 中的 add 函数
print(calculator.add(4, 5))  # 输出：9
```

运行 `test.py` 时，`calculator.py` 中的 `__name__` 值是 `"calculator"`（模块名），因此 `if __name__ == "__main__":` 条件不成立，`calculator.py` 中缩进块内的代码（`print("模块被直接运行了！")` 等）不会执行。


### 4. 为什么需要这个结构？
- **提高代码复用性**：一个模块既能作为工具被导入（提供函数/类），又能作为独立脚本运行（执行测试或主逻辑）。
- **避免副作用**：如果没有这个结构，当模块被导入时，脚本中的所有代码（包括测试代码）都会被执行，可能导致意外结果。
- **便于测试**：可以在模块内部写一些测试代码，直接运行模块就能验证功能，无需额外的测试文件。


### 总结
`if __name__ == "__main__":` 是 Python 中区分模块“直接运行”和“被导入”的经典方式，它让模块更灵活、更安全，是编写可复用代码的重要实践。