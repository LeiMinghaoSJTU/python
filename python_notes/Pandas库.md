// The above code is a detailed guide on using the pandas library in Python for data processing and
// analysis. It covers the following main topics:
pandas 是 Python 中用于数据处理和分析的核心库，其设计初衷是简化结构化数据的操作。下面将介绍 pandas 中最常用的数据结构以及高频函数的用法。


### 一、常用数据结构
pandas 的核心数据结构有两种：**Series**（一维）和 **DataFrame**（二维），它们是处理各类数据的基础。


#### 1. Series（一维数组）
Series 是带标签（索引）的一维数组，可存储任意数据类型（整数、字符串、浮点数等）。  
**创建方式**：
```python
import pandas as pd

# 从列表创建（默认索引为 0,1,2...）
s1 = pd.Series([10, 20, 30, 40])
print(s1)
# 输出：
# 0    10
# 1    20
# 2    30
# 3    40
# dtype: int64

# 自定义索引
s2 = pd.Series([10, 20, 30], index=['a', 'b', 'c'])
print(s2)
# 输出：
# a    10
# b    20
# c    30
# dtype: int64

# 从字典创建（键为索引，值为数据）
s3 = pd.Series({'北京': 2000, '上海': 2500, '广州': 1800})
```

**核心属性**：
- `index`：获取索引（标签）
- `values`：获取数据值（numpy 数组格式）
- `dtype`：获取数据类型
```python
print(s2.index)   # Index(['a', 'b', 'c'], dtype='object')
print(s2.values)  # [10 20 30]
print(s2.dtype)   # int64
```


#### 2. DataFrame（二维表格）
DataFrame 是带标签的二维表格结构，可理解为"多个 Series 共用一个索引"，每列可以是不同的数据类型。  
**创建方式**：
```python
# 从字典创建（键为列名，值为列表/Series）
data = {
    '姓名': ['张三', '李四', '王五'],
    '年龄': [25, 30, 35],
    '城市': ['北京', '上海', '广州']
}
df = pd.DataFrame(data)
print(df)
# 输出：
#   姓名  年龄  城市
# 0  张三  25  北京
# 1  李四  30  上海
# 2  王五  35  广州

# 自定义行索引df = pd.DataFrame(data, index=['员工1', '员工2', '员工3'])
```

**核心属性**：
- `shape`：获取表格形状（行数, 列数）
- `columns`：获取列名
- `index`：获取行索引
- `dtypes`：查看各列数据类型
```python
print(df.shape)    # (3, 3)
print(df.columns)  # Index(['姓名', '年龄', '城市'], dtype='object')
```


### 二、常用函数用法
pandas 的函数覆盖了数据处理的全流程（读取、查看、清洗、转换、分析等），以下是高频函数分类介绍。


#### 1. 数据读取与保存
用于从文件读取数据或保存数据到文件（支持 CSV、Excel、JSON 等格式）。

| 函数              | 作用              | 示例                                                                 |
| ----------------- | ----------------- | -------------------------------------------------------------------- |
| `pd.read_csv()`   | 读取 CSV 文件     | `df = pd.read_csv('data.csv')`                                       |
| `pd.read_excel()` | 读取 Excel 文件   | `df = pd.read_excel('data.xlsx')`                                    |
| `df.to_csv()`     | 保存为 CSV 文件   | `df.to_csv('output.csv', index=False)`（`index=False` 不保存行索引） |
| `df.to_excel()`   | 保存为 Excel 文件 | `df.to_excel('output.xlsx', sheet_name='数据')`                      |


#### 2. 数据查看与基础统计
用于快速了解数据概览。

| 函数                | 作用                                               | 示例                        |
| ------------------- | -------------------------------------------------- | --------------------------- |
| `df.head(n)`        | 查看前 n 行（默认 5 行）                           | `df.head(3)`                |
| `df.tail(n)`        | 查看后 n 行                                        | `df.tail(2)`                |
| `df.info()`         | 查看数据基本信息（行数、列数、数据类型、缺失值等） | `df.info()`                 |
| `df.describe()`     | 对数值列进行统计分析（均值、标准差、最值等）       | `df.describe()`             |
| `df.value_counts()` | 统计某列值的出现次数（适用于 Series 或单列）       | `df['城市'].value_counts()` |


#### 3. 数据选择与筛选
用于提取需要的行/列或满足条件的数据。

| 操作        | 作用                    | 示例                                                                                                                 |
| ----------- | ----------------------- | -------------------------------------------------------------------------------------------------------------------- |
| 列选择      | 提取一列或多列          | `df['姓名']`（单列，返回 Series）<br>`df[['姓名', '年龄']]`（多列，返回 DataFrame）                                  |
| `df.loc[]`  | 按标签（索引/列名）选择 | `df.loc['员工1', '年龄']`（选"员工1"的"年龄"）<br>`df.loc[:, ['姓名', '城市']]`（选所有行的"姓名"和"城市"列）        |
| `df.iloc[]` | 按位置（整数索引）选择  | `df.iloc[0, 1]`（选第 0 行第 1 列）<br>`df.iloc[0:2, :]`（选前 2 行所有列）                                          |
| 条件筛选    | 按条件提取行            | `df[df['年龄'] > 28]`（年龄大于 28 的行）<br>`df[(df['年龄'] > 25) & (df['城市'] == '北京')]`（多条件，用 `&` 连接） |


#### 4. 数据清洗
处理缺失值、重复值等问题。

| 函数                   | 作用                         | 示例                                                                                                   |
| ---------------------- | ---------------------------- | ------------------------------------------------------------------------------------------------------ |
| `df.isnull()`          | 检测缺失值（返回布尔值表格） | `df.isnull().sum()`（统计每列缺失值数量）                                                              |
| `df.dropna()`          | 删除含缺失值的行/列          | `df.dropna(axis=0)`（删除含缺失值的行，默认）<br>`df.dropna(axis=1)`（删除含缺失值的列）               |
| `df.fillna()`          | 填充缺失值                   | `df['年龄'].fillna(30)`（用 30 填充"年龄"列的缺失值）<br>`df.fillna(method='ffill')`（用前一个值填充） |
| `df.duplicated()`      | 检测重复行                   | `df.duplicated()`（返回布尔值，True 表示重复）                                                         |
| `df.drop_duplicates()` | 删除重复行                   | `df.drop_duplicates(subset=['姓名'])`（按"姓名"去重）                                                  |


#### 5. 数据转换与处理
对数据进行格式转换、计算等操作。

| 函数               | 作用                               | 示例                                                       |
| ------------------ | ---------------------------------- | ---------------------------------------------------------- |
| `df.astype()`      | 转换列的数据类型                   | `df['年龄'] = df['年龄'].astype(float)`（年龄转为浮点型）  |
| `df.apply()`       | 对行/列应用自定义函数              | `df['年龄'].apply(lambda x: x+1)`（年龄列每个值加 1）      |
| `df.map()`         | 对 Series 应用映射（常用于替换值） | `df['城市'].map({'北京': '北方', '上海': '南方'})`         |
| `df.rename()`      | 重命名列名/索引                    | `df.rename(columns={'姓名': 'name', '年龄': 'age'})`       |
| `df.sort_values()` | 按列值排序                         | `df.sort_values(by='年龄', ascending=False)`（按年龄降序） |


#### 6. 数据分组与聚合
按某列分组后进行统计分析（类似 SQL 的 GROUP BY）。

```python
# 按"城市"分组，计算每个城市的平均年龄
grouped = df.groupby('城市')
print(grouped['年龄'].mean())
# 输出：
# 城市
# 北京    25.0
# 上海    30.0
# 广州    35.0
# Name: 年龄, dtype: float64

# 多列聚合（同时计算均值和最大值）
grouped['年龄'].agg(['mean', 'max'])
```


#### 7. 数据合并与连接
将多个 DataFrame 合并（类似 SQL 的 JOIN）。

| 函数          | 作用                            | 示例                                              |
| ------------- | ------------------------------- | ------------------------------------------------- |
| `pd.concat()` | 拼接多个 DataFrame（行/列方向） | `pd.concat([df1, df2], axis=0)`（行拼接）         |
| `pd.merge()`  | 按列连接（类似 SQL 的 JOIN）    | `pd.merge(df1, df2, on='姓名')`（按"姓名"列连接） |


### 总结
pandas 的核心是 Series 和 DataFrame 两种数据结构，配合上述函数可以完成从数据读取、清洗到分析的全流程操作。实际使用中，这些函数经常组合使用，例如先读取数据，再用 `info()` 查看缺失值，接着用 `fillna()` 填充，最后用 `groupby()` 做分组分析。熟练掌握这些基础后，可以进一步学习窗口函数、时间序列处理等高级功能。